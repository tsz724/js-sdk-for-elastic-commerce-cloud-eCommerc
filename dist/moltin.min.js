/*! moltin-sdk minified - v0.6.0 - 2014-06-17 */
var Moltin,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};Moltin=function(){"use strict";function a(a){this.options=this.Merge(this.options,a),this.Storage=new k,this.Brand=new b(this),this.Cart=new c(this),this.Category=new d(this),this.Collection=new e(this),this.Currency=new f(this),this.Gateway=new h(this),this.Product=new i(this),this.Shipping=new j(this),this.Tax=new l(this),this.Storage.get("mcurrency")&&(this.options.currency=this.Storage.get("mcurrency"))}var b,c,d,e,f,g,h,i,j,k,l;return a.prototype.options={publicId:"",auth:{},url:"https://api.molt.in/",version:"beta",debug:!1,currency:!1,notice:function(a,b){return alert(a+": "+b)},methods:["GET","POST","PUT","DELETE"]},a.prototype.Merge=function(a,b){var c,d,e;d={};for(c in a)e=a[c],d[c]=e;for(c in b)e=b[c],d[c]=e;return d},a.prototype.InArray=function(a,b){return __indexOf.call(b,a)<0?!1:!0},a.prototype.Serialize=function(a,b){var c,d,e;null==b&&(b=null),d=[];for(c in a)e=a[c],c=null!==b?b+"["+c+"]":c,d.push("object"==typeof e?this.Serialize(e(c)):encodeURIComponent(c)+"="+encodeURIComponent(e));return d.join("&")},a.prototype.Error=function(a){var b,c,d,e;if(c="","undefind"!=typeof a.errors){e=a.errors;for(b in e)d=e[b],c+=d+"<br />"}else c=a.error;return this.options.notice("Error",c)},a.prototype.Ajax=function(a){var b,c,d,e,f,g,h;b={type:"GET",async:!1,data:null,timeout:5e3,headers:{},url:this.options.url+this.options.version,success:function(){},error:function(){}},b=this.Merge(b,a);try{e=new XMLHttpRequest}catch(i){c=i;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){return c=i,!1}}e.open(b.type.toUpperCase(),b.url,b.async),f=setTimeout(function(a){return function(){return e.abort(),b.error(a.options.notice("error","Your request timed out"))}}(this),b.timeout),h=b.headers;for(d in h)g=h[d],e.setRequestHeader(d,g);return e.onreadystatechange=function(){var a;return 4!==e.readyState?null:(clearTimeout(f),a=JSON.parse(e.responseText),200!==e.status?b.error(e,e.status,a):b.success(a,e.status,e))},e.send(this.Serialize(b.data))},a.prototype.Authenticate=function(a){var b;return this.options.publicId.length<=0?this.options.notice("error","Public ID must be set"):null!==this.Storage.get("mtoken")&&parseInt(this.Storage.get("mexpires"))>new Date/1e3|0?(this.options.auth={token:this.Storage.get("mtoken"),expires:this.Storage.get("mexpires")},"function"==typeof a&&a(this.options.auth),b=new CustomEvent("MoltinReady",this.options.auth),void window.dispatchEvent(b)):this.Ajax({type:"POST",url:this.options.url+"oauth/access_token",data:{grant_type:"implicit",client_id:this.options.publicId},async:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(c){return function(d){return c.options.auth={token:d.access_token,expires:parseInt(d.expires)},c.Storage.set("mtoken",d.access_token),c.Storage.set("mexpires",c.options.auth.expires),"function"==typeof a&&a(d),b=new CustomEvent("MoltinReady",d),window.dispatchEvent(b)}}(this),error:function(a){return function(){return a.options.notice("error","Authorization failed")}}(this)})},a.prototype.Request=function(a,b,c,d){var e,f;return null==b&&(b="GET"),null==c&&(c=null),e={},f={"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.options.auth.token},null===this.options.auth.token?this.options.notice("error","You much authenticate first"):this.InArray(b,this.options.methods)?(this.options.currency&&(f["X-Currency"]=this.options.currency),this.Ajax({type:b,url:this.options.url+this.options.version+"/"+a,data:c,async:"function"==typeof d?!0:!1,headers:f,success:function(){return function(a){return"function"==typeof d?d(a.result):e=a}}(this),error:function(a){return function(b){var c,d,f,g,h;if(f=JSON.parse(b.responseText),f.status===!1){if(null!=f.errors){h=f.errors;for(d in h)g=h[d],c+=g+"\n"}else c=f.error;a.options.notice("error",c)}return e=f}}(this)}),null===d?e:void 0):this.options.notice("error","Invalid request method ("+b+")")},g=function(){function a(){}return a}(),k=function(){function a(){}return a.prototype.set=function(a,b,c){var d,e;return e="",c&&(d=new Date,d.setTime(d.getTime()+24*c*60*60*1e3),e="; expires="+d.toGMTString()),document.cookie=a+"="+b+e+"; path=/"},a.prototype.get=function(a){var b,c,d,e;for(a+="=",e=document.cookie.split(";"),c=0,d=e.length;d>c;c++){for(b=e[c];" "===b.charAt(0);)b=b.substring(1,b.length);if(0===b.indexOf(a))return b.substring(a.length,b.length)}return null},a.prototype.remove=function(a){return this.set(a,"",-1)},a}(),b=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("brand/"+a,"GET",null,b)},a.prototype.Find=function(a,b){return this.m.Request("brand","GET",a,b)},a.prototype.List=function(a,b){return this.m.Request("brands","GET",a,b)},a.prototype.Fields=function(a,b){var c;return null==a&&(a=0),c="brand/"+(0!==a?a+"/fields":"fields"),this.m.Request(c,"GET",null,b)},a}(),c=function(){function a(a){this.m=a,this.identifier=this.GetIdentifier()}return a.prototype.GetIdentifier=function(){var a;return this.m.Storage.get(!0)?this.m.Storage.get("mcart"):(a="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(){return(16*Math.random()|0).toString(16)}),this.m.Storage.set("mcart",a),a)},a.prototype.Contents=function(a){return this.m.Request("cart/"+this.identifier,"GET",null,a)},a.prototype.Insert=function(a,b,c){return null==b&&(b=1),this.m.Request("cart/"+this.identifier,"POST",{id:a,quantity:b},c)},a.prototype.Update=function(a,b,c){return null==b&&(b=1),this.m.Request("cart/"+this.identifier+"/item/"+a,"PUT",{id:a,quantity:b},c)},a.prototype.Remove=function(a,b){return this.m.Request("cart/"+this.identifier+"/item/"+a,"DELETE",null,b)},a.prototype.Item=function(a,b){return this.m.Request("cart/"+this.identifier+"/item/"+a,"GET",null,b)},a.prototype.InCart=function(a,b){return this.m.Request("cart/"+this.identifier+"/has/"+a,"GET",null,b)},a}(),d=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("category/"+a,"GET",null,b)},a.prototype.Find=function(a,b){return this.m.Request("category","GET",a,b)},a.prototype.List=function(a,b){return this.m.Request("categories","GET",a,b)},a.prototype.Tree=function(a){return this.m.Request("categories/tree","GET",null,a)},a.prototype.Fields=function(a,b){var c;return null==a&&(a=0),c="category/"+(0!==a?a+"/fields":"fields"),this.m.Request(c,"GET",null,b)},a}(),e=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("collection/"+a,"GET",null,b)},a.prototype.Find=function(a,b){return this.m.Request("collection","GET",a,b)},a.prototype.List=function(a,b){return this.m.Request("collections","GET",a,b)},a.prototype.Fields=function(a,b){var c;return null==a&&(a=0),c="collection/"+(0!==a?a+"/fields":"fields"),this.m.Request(c,"GET",null,b)},a}(),f=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("currency/"+a,"GET",null,b)},a.prototype.Set=function(a,b){return this.m.Storage.set("mcurrency",a),this.m.options.currency=a,"function"==typeof b?b(a):void 0},a.prototype.Find=function(a,b){return this.m.Request("currency","GET",a,b)},a.prototype.List=function(a,b){return this.m.Request("currencies","GET",a,b)},a.prototype.Fields=function(a,b){var c;return null==a&&(a=0),c="currency/"+(0!==a?a+"/fields":"fields"),this.m.Request(c,"GET",null,b)},a}(),h=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("gateway/"+a,"GET",null,b)},a.prototype.List=function(a,b){return this.m.Request("gateways","GET",a,b)},a}(),i=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("product/"+a,"GET",null,b)},a.prototype.Find=function(a,b){return this.m.Request("product","GET",a,b)},a.prototype.List=function(a,b){return this.m.Request("products","GET",a,b)},a.prototype.Search=function(a,b){return this.m.Request("products/search","GET",a,b)},a.prototype.Fields=function(a,b){var c;return null==a&&(a=0),c="product/"+(0!==a?a+"/fields":"fields"),this.m.Request(c,"GET",null,b)},a.prototype.Modifiers=function(a,b){return this.m.Request("product/"+a+"/modifiers","GET",null,b)},a.prototype.Variations=function(a){return this.m.Request("product/"+a+"/variations","GET",null,callback)},a}(),j=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("shipping/"+a,"GET",null,b)},a.prototype.List=function(a,b){return this.m.Request("shipping","GET",a,b)},a}(),l=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b){return this.m.Request("tax/"+a,"GET",null,b)},a.prototype.Find=function(a,b){return this.m.Request("tax","GET",a,b)},a.prototype.List=function(a,b){return this.m.Request("taxes","GET",a,b)},a.prototype.Fields=function(a,b){var c;return null==a&&(a=0),c="tax/"+(0!==a?a+"/fields":"fields"),this.m.Request(c,"GET",null,b)},a}(),a}();
//# sourceMappingURL=moltin.min.js.map